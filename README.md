# Crisis Counseling Simulator

An AI-powered crisis counseling training simulator built on Cloudflare’s edge platform.  
This application allows users to practice crisis intervention skills through realistic, scenario-based conversations and receive structured, expert-style feedback at the end of each session.

---

## Overview

The Crisis Counseling Simulator is designed as a training and reflection tool rather than a replacement for real mental health services. Users take on the role of a counselor and interact with simulated clients experiencing various crisis scenarios (e.g., anxiety, grief, suicidal ideation). Each session is stateful, persisted across messages, and evaluated at the end using an AI-generated supervisory review.

Key goals:
- Practice empathetic, de-escalatory counseling responses
- Maintain consistent session state across interactions
- Generate structured qualitative feedback after each session
- Demonstrate a modern, serverless, edge-first architecture

---

## Live Deployment

**Frontend (Cloudflare Pages):**  
https://crisis-counselor.pages.dev

**Backend API (Cloudflare Workers):**  
https://crisis-counselor-v2.isaacwells919.workers.dev

---

## Features

- **Scenario-based simulations**
  - Suicidal ideation
  - Panic attacks / anxiety
  - Grief and loss
  - Academic crisis

- **Stateful conversations**
  - Each session is backed by a Durable Object
  - Conversation history persists across requests

- **AI-powered responses**
  - Simulated client behavior adapts to counselor input
  - Responses are generated using Cloudflare AI models

- **Post-session feedback**
  - AI-generated supervisory evaluation
  - Assesses empathy, safety assessment, de-escalation, and more

- **Persistent storage**
  - Sessions and messages stored in Cloudflare D1 (SQLite)
  - User progress tracked across sessions

---

## Architecture

### High-level design

Browser (Pages)
│
│ HTTP (fetch)
▼
Cloudflare Worker (Hono API)
│
├── Durable Object (Session state)
│ └── Conversation history
│
├── Cloudflare AI
│ ├── Client simulation
│ └── Feedback generation
│
└── Cloudflare D1
├── sessions
├── messages
└── user_progress


### Core components

- **Cloudflare Pages**
  - Hosts the static frontend (`public/index.html`)
  - Handles user interaction and UI state

- **Cloudflare Workers**
  - API layer implemented using Hono
  - Routes session lifecycle endpoints (`start`, `message`, `end`)

- **Durable Objects**
  - One Durable Object per session
  - Responsible for maintaining authoritative conversation history
  - Identified by a stable `sessionId`

- **Cloudflare D1**
  - SQLite-backed persistent storage
  - Stores session metadata, messages, and user progress

- **Cloudflare AI**
  - Generates simulated client responses
  - Produces structured supervisory feedback at session end

---

## Data Model

### Tables

- **sessions**
  - Session metadata (user, scenario, timestamps, feedback)

- **messages**
  - Individual messages associated with a session

- **user_progress**
  - Aggregate user statistics and historical performance

Schema is defined in `schema.sql`.

---

## Session Flow

1. User selects a scenario
2. Worker generates a `sessionId`
3. Durable Object is created using `sessionId` as its identity
4. Conversation proceeds with:
   - Counselor messages from the user
   - Client responses generated by AI
5. On session end:
   - Full conversation history is retrieved from the Durable Object
   - AI generates structured feedback
   - Results are persisted and returned to the frontend

---

## Local Development

### Prerequisites
- Node.js
- Wrangler CLI (`npm install -g wrangler`)
- Cloudflare account

### Setup

```bash
npm install

Apply the database schema locally or remotely:
wrangler d1 execute crisis_counselor_db --remote --file=./schema.sql

Run locally:
wrangler dev

Deployment
Deploy the Worker:
wrangler deploy

Deploy the frontend:
wrangler pages deploy public --project-name crisis-counselor

Disclaimer
This project is for educational and training purposes only.
It is not a substitute for professional mental health services.
If you or someone else is in immediate danger, contact local emergency services or a licensed mental health professional.

Author
Isaac Wells
